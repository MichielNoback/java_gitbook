
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Implementing MVC Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="thymeleaf_expressions.html" />
    
    
    <link rel="prev" href="first_project.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Java
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../shortcuts.html">
            
                <a href="../shortcuts.html">
            
                    
                    IntelliJ keyboard shortcuts
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 1: Getting started</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../01_getting_started/intellij.html">
            
                <a href="../01_getting_started/intellij.html">
            
                    
                    A first IntelliJ project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../01_getting_started/essentials.html">
            
                <a href="../01_getting_started/essentials.html">
            
                    
                    The essentials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../01_getting_started/first_look_at_objects.html">
            
                <a href="../01_getting_started/first_look_at_objects.html">
            
                    
                    Demo case: A first look at objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../02_syntax/basic_program_design.html">
            
                <a href="../02_syntax/basic_program_design.html">
            
                    
                    Basic program design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../02_syntax/naming_commenting.html">
            
                <a href="../02_syntax/naming_commenting.html">
            
                    
                    Naming and commenting
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 2: Syntax</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../02_syntax/data_types.html">
            
                <a href="../02_syntax/data_types.html">
            
                    
                    Data types
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../02_syntax/arrays.html">
            
                <a href="../02_syntax/arrays.html">
            
                    
                    Arrays
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../02_syntax/operators.html">
            
                <a href="../02_syntax/operators.html">
            
                    
                    Operators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../02_syntax/flow_control.html">
            
                <a href="../02_syntax/flow_control.html">
            
                    
                    Flow control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../02_syntax/methods.html">
            
                <a href="../02_syntax/methods.html">
            
                    
                    Methods
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="../02_syntax/packages_imports.html">
            
                <a href="../02_syntax/packages_imports.html">
            
                    
                    Packages & Imports
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="../02_syntax/demo_case_naming.html">
            
                <a href="../02_syntax/demo_case_naming.html">
            
                    
                    Demo case: The power of good names
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 3: Core APIs</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../03_apis/interfaces.html">
            
                <a href="../03_apis/interfaces.html">
            
                    
                    Interfaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../03_apis/collections.html">
            
                <a href="../03_apis/collections.html">
            
                    
                    Collections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="../03_apis/class_object_methods.html">
            
                <a href="../03_apis/class_object_methods.html">
            
                    
                    Methods of class Object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../03_apis/sorting.html">
            
                <a href="../03_apis/sorting.html">
            
                    
                    Sorting
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../03_apis/exceptions.html">
            
                <a href="../03_apis/exceptions.html">
            
                    
                    Exceptions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="../03_apis/io.html">
            
                <a href="../03_apis/io.html">
            
                    
                    File IO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="../03_apis/regex.html">
            
                <a href="../03_apis/regex.html">
            
                    
                    Regular Expressions
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 4: Object-oriented programming</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../04_oop/class_design.html">
            
                <a href="../04_oop/class_design.html">
            
                    
                    Encapsulation through access modifiers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../04_oop/access_modifiers.html">
            
                <a href="../04_oop/access_modifiers.html">
            
                    
                    Access modifiers & other keywords
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../04_oop/inheritance.html">
            
                <a href="../04_oop/inheritance.html">
            
                    
                    Inheritance and UML
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="../04_oop/enums.html">
            
                <a href="../04_oop/enums.html">
            
                    
                    Enums
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="../04_oop/encapsulation.html">
            
                <a href="../04_oop/encapsulation.html">
            
                    
                    Encapsulation revisited
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="../04_oop/inner_classes.html">
            
                <a href="../04_oop/inner_classes.html">
            
                    
                    Inner classes
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Summaries Part 1-4</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../design_rules.html">
            
                <a href="../design_rules.html">
            
                    
                    Design Rules summary
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 5: Web-based Java & Thymeleaf</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="refresher.html">
            
                <a href="refresher.html">
            
                    
                    Refresher
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="toolbox.html">
            
                <a href="toolbox.html">
            
                    
                    Toolbox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="first_project.html">
            
                <a href="first_project.html">
            
                    
                    A first project
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="7.4" data-path="mvc.html">
            
                <a href="mvc.html">
            
                    
                    Implementing MVC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.5" data-path="thymeleaf_expressions.html">
            
                <a href="thymeleaf_expressions.html">
            
                    
                    Thymeleaf expression types & objects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.6" data-path="thymeleaf_flow_control.html">
            
                <a href="thymeleaf_flow_control.html">
            
                    
                    Thymeleaf flow control & fragments
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.7" data-path="sessions.html">
            
                <a href="sessions.html">
            
                    
                    Sessions & Scopes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.8" data-path="servlet_details.html">
            
                <a href="servlet_details.html">
            
                    
                    Servlet details & Lifecycle hooks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.9" data-path="databases.html">
            
                <a href="databases.html">
            
                    
                    Database interaction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.10" data-path="ajax.html">
            
                <a href="ajax.html">
            
                    
                    Ajax communication
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.11" data-path="filters_upload.html">
            
                <a href="filters_upload.html">
            
                    
                    Web filters and file uploads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.12" data-path="webbased_exercises1.html">
            
                <a href="webbased_exercises1.html">
            
                    
                    Exercises Web-based Information Systems 1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.13" data-path="html_cheatsheet.html">
            
                <a href="html_cheatsheet.html">
            
                    
                    html cheat sheet
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 6: Developer tools</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../06_tools/JUnit_basics.html">
            
                <a href="../06_tools/JUnit_basics.html">
            
                    
                    JUnit 5 Basics
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="../06_tools/JUnit_advanced.html">
            
                <a href="../06_tools/JUnit_advanced.html">
            
                    
                    JUnit 5 Advanced
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part 7: Design</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../07_design/demo_case_refactoring.html">
            
                <a href="../07_design/demo_case_refactoring.html">
            
                    
                    JUnit 5 Basics
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Implementing MVC</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="implementing-mvc">Implementing MVC</h1>
<p>The topic of this post is setting up a clean &#x201C;MVC&#x201C; Java web application.
This involves working with separated components for different responsibilities. Besides the Model, the View and the Controller, this post also deals with the Data Layer, a fourth component that is almost always a part of a web app.</p>
<h2 id="the-components-aka-layers">The Components a.k.a Layers</h2>
<p>The components -or layers- of an MVS application are generally recognized in most applications, 
web-based or not:</p>
<ul>
<li><strong>Model</strong>: the business-specific logic, model classes, domain-specific algorithms</li>
<li><strong>View</strong>: what the user gets to see, often the visual representation of the underlying data</li>
<li><strong>Controller</strong>: receives input or requests (from the user) and determines what action should be taken; what part of the model should be invoked</li>
<li><strong>Data layer</strong>: all data is abstracted away behind data access objects (DAOs)</li>
</ul>
<p><img src="figures/mvc_pattern2s.png" alt="Create WEB-INF" title="MVC pattern (extended)"></p>
<h2 id="the-goal-a-random-phrase-of-the-day">The goal: a random phrase of the day</h2>
<p>The specs: a web app that will display a phrase, chosen randomly from one of two categories: Bullshit or Management.</p>
<p>This post assumes you already have created a new Gradle-managed web app - see post 
<a href="first_project.html">First Project</a></p>
<h2 id="java-web-app-architecture">Java web app architecture</h2>
<p>Java web apps are managed by servers, also called containers. We work with Tomcat, but the idea is the same for all.
Tomcat receives requests and forwards these to specific entry points in your app. 
These entry points are not <code>main()</code> methods as in Commandline apps, but the service methods of Servlets: 
<code>void doGet(HttpServletRequest request, HttpServletResponse response)</code> and <code>doPost(HttpServletRequest request, HttpServletResponse response)</code>. 
Also, unlike commandline apps that receive their arguments via the <code>String[] args</code> argument to <code>main()</code>, the service methods receive <code>HttpServletRequest</code> and <code>HttpServletResponse</code> objects as their communication channels to the outside world: the request object is the way in and the response object is the connection out.</p>
<p>Besides these objects, there is the <code>HttpSession</code> object supporting &quot;cross-request memory&quot;, and the <code>ServletContext</code> object that you use for application-wide configuration settings. And throughout the app, Plain Old Java Objects (POJOs) serve as data carriers - the glue of the app. Here is a schema of an entire app.</p>
<p><img src="figures/java_web_app_architecture.png" alt="java_web_app_architecture.png"></p>
<h2 id="a-view">A View</h2>
<p>To create a Thymeleaf template, right-click on folder webapp/templates, select New &#x2192; html.
(Hint: you can also make your own Thymeleaf template!)</p>
<p>Name it phrase_of_the_day.html and click OK
The file will automatically open in an editor window, with some standard template code already present. </p>
<p>Here is the contents of <code>phrase_of_the_day.html</code> </p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE html SYSTEM &quot;http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd&quot;&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.w3.org/1999/xhtml&quot;</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html; charset=UTF-8&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;#{tab.title}&quot;</span>&gt;</span>_offline_<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;#{page.title}&quot;</span>&gt;</span>Offline title<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;#{page.subtitle}&quot;</span>&gt;</span>Offline subtitle<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;give.phrase&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;GET&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;phrase_category&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;bullshit&quot;</span>&gt;</span>Bullshit<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;management&quot;</span>&gt;</span>Management<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">th:value</span>=<span class="hljs-string">&quot;#{get.phrase.btn}&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;_offline_&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">h4</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;#{&apos;phrase.&apos; + ${phrase_num}}&quot;</span>&gt;</span>_phrase placeholder_<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>Note the text have been moved to a resource bundle.</p>
<p>Within the editor pane, click the icon of the browser you want to view the file in (the browser icons are in the top right corner).
Do not select &#x201C;Run phrase<em>of</em>...&#x201D; from the context menu because you will get a 404!</p>
<p><img src="figures/phrase_request_form1.png" alt="phrase_request_form1.png"></p>
<p>You won&apos;t get any texts into the placeholders because (1) there simply aren&apos;t any and (2) you are viewing a static html page, not a view that is processed by the template engine.</p>
<h3 id="create-resource-bundle">Create resource bundle</h3>
<p>The resource should have as base name <code>phrase_of_the_day</code> and should have a default and &apos;en&apos; locale versions.
You also need entries for the used texts, of course</p>
<p><img src="figures/phrase_of_the_day_resource_bundle.png" alt="phrase_of_the_day_resource_bundle.png"></p>
<h2 id="a-model">A model</h2>
<p>Create a new package called <code>model</code>.
Give it some dummy implementation (we&#x2019;ll put some real code in there later on).</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PhraseFactory</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPhrase</span><span class="hljs-params">(String phraseType)</span> </span>{
        <span class="hljs-comment">//we&apos;ll get to this later!</span>
        <span class="hljs-comment">//You thought I&#x2019;d return some text here, didn&#x2019;t you?</span>
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;1&quot;</span>;
    }
}
</code></pre>
<h2 id="a-controller">A controller</h2>
<p>Create a new Servlet and put the following code in there. </p>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> nl.bioinf.wis_on_thymeleaf.servlets;

<span class="hljs-comment">//many imports</span>

<span class="hljs-meta">@WebServlet</span>(name = <span class="hljs-string">&quot;PhraseServlet&quot;</span>, urlPatterns = <span class="hljs-string">&quot;/give.phrase&quot;</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PhraseServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HttpServlet</span> </span>{
    <span class="hljs-keyword">private</span> TemplateEngine templateEngine;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> ServletException </span>{
        <span class="hljs-keyword">this</span>.templateEngine = WebConfig.getTemplateEngine();
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">doGet</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span>
            <span class="hljs-keyword">throws</span> ServletException, IOException </span>{
        String phraseType = request.getParameter(<span class="hljs-string">&quot;phrase_category&quot;</span>);
        Locale locale = request.getLocale();
        WebContext ctx = <span class="hljs-keyword">new</span> WebContext(
                request,
                response,
                request.getServletContext(),
                locale);
        <span class="hljs-keyword">if</span> (phraseType != <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">final</span> String phrase = PhraseFactory.getPhrase(phraseType);
            ctx.setVariable(<span class="hljs-string">&quot;phrase_type&quot;</span>, phraseType);
            ctx.setVariable(<span class="hljs-string">&quot;phrase_num&quot;</span>, phrase);
        } <span class="hljs-keyword">else</span> {
            ctx.setVariable(<span class="hljs-string">&quot;phrase_type&quot;</span>, <span class="hljs-string">&quot;none&quot;</span>);
            ctx.setVariable(<span class="hljs-string">&quot;phrase_num&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>);
        }
        templateEngine.process(<span class="hljs-string">&quot;phrase_of_the_day&quot;</span>, ctx, response.getWriter());
    }
}
</code></pre>
<p>The controller receives request parameters from the submitted form using <code>String requestParameter = request.getParameter(&quot;&lt;parameter_name&gt;&quot;);</code>. On the output side, it passed data to the Thymeleaf template using <code>ctx.setVariable(&quot;&lt;variable_name&gt;&quot;, &lt;variable&gt;);</code>. It is not responsible for any application logic; for that it calls on the model class <code>PhraseFactory</code>. The controller does not involve itself with the view either; it simply passes the data it received from the model to the View component, the Thymeleaf template <code>phrase_of_the_day.html</code>.</p>
<h2 id="test">Test!</h2>
<p>Create a new run configuration called &quot;phrase&quot; and point it to give.phrase.</p>
<p>Test the result; try the form submit; change your language; refresh</p>
<p><img src="figures/phrase_request_form2_en.png" alt="phrase_request_form2.png"></p>
<p><img src="figures/phrase_request_form3_nl.png" alt="phrase_request_form3.png"></p>
<h2 id="extend-the-model">Extend the model</h2>
<p>Implement some nice behavior in <code>PhraseFactory.java</code>.
First the Junit5 test and only then the implementation: this is called Test-Driven Development (TDD).</p>
<pre><code class="lang-java"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PhraseFactoryTest</span> </span>{
    <span class="hljs-meta">@Test</span>
    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">getPhrase</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">50</span>; i++) {
            <span class="hljs-keyword">int</span> random = Integer.parseInt(PhraseFactory.getPhrase(<span class="hljs-string">&quot;bullshit&quot;</span>));
            assertTrue(random &gt;= <span class="hljs-number">1</span> &amp;&amp; random &lt;= PhraseFactory.MAX_PHRASE_COUNT);
        }
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">50</span>; i++) {
            <span class="hljs-keyword">int</span> random = Integer.parseInt(PhraseFactory.getPhrase(<span class="hljs-string">&quot;management&quot;</span>));
            assertTrue(random &gt;= <span class="hljs-number">1</span> &amp;&amp; random &lt;= PhraseFactory.MAX_PHRASE_COUNT);
        }
    }
}
</code></pre>
<p>The implementation.</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PhraseFactory</span> </span>{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> MAX_PHRASE_COUNT = <span class="hljs-number">4</span>;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title">getPhrase</span><span class="hljs-params">(String phraseType)</span> </span>{
        <span class="hljs-comment">//I only have 4 phrases of each category</span>
        Random rand = <span class="hljs-keyword">new</span> Random();
        <span class="hljs-keyword">int</span> phraseIndex = rand.nextInt(MAX_PHRASE_COUNT) + <span class="hljs-number">1</span>;
        <span class="hljs-keyword">return</span> Integer.toString(phraseIndex);
    }
}
</code></pre>
<p>Now fetch the phrases a little bit sophisticated. Here is the relevant part of the Thymeleaf template.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-name">h4</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">&quot;#{&apos;phrase.&apos; + ${phrase_type} + &apos;.&apos; + ${phrase_num}}&quot;</span>&gt;</span>_phrase placeholder_<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
</code></pre>
<p>This snippet is building a reference to a randomly chosen phrase from the requested category.</p>
<p>In the resource bundle, the phrases are stored in two languages.</p>
<p><img src="figures/phrase_of_the_day_resource_bundle2.png" alt="phrase_of_the_day_resource_bundle2.png"></p>
<h2 id="mvc-complete">MVC complete</h2>
<p>Thats it; you have seen the MVC pattern in action. There is a dedicated model class that knows how to provide a random choice for messages. 
The Servlet controller invokes the model (PhraseFactory) and dispatches its output to the view. 
The Thymeleaf template handles the view, processed by the template engine that is also responsible for injecting the text messages from the resource bundle, in the correct language.</p>
<p>Thymeleaf has several techniques to deal with dynamic content generated by the model; this is the subject of the next post.</p>
<p><img src="figures/mvc_pattern2s.png" alt="Create WEB-INF" title="MVC pattern (extended)"></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="first_project.html" class="navigation navigation-prev " aria-label="Previous page: A first project">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="thymeleaf_expressions.html" class="navigation navigation-next " aria-label="Next page: Thymeleaf expression types & objects">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Implementing MVC","level":"7.4","depth":1,"next":{"title":"Thymeleaf expression types & objects","level":"7.5","depth":1,"path":"05_web/thymeleaf_expressions.md","ref":"05_web/thymeleaf_expressions.md","articles":[]},"previous":{"title":"A first project","level":"7.3","depth":1,"path":"05_web/first_project.md","ref":"05_web/first_project.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["page-toc"],"pluginsConfig":{"page-toc":{"position":"before-first","selector":".markdown-section h1, .markdown-section h2, .markdown-section h3","showByDefault":true},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"05_web/mvc.md","mtime":"2019-12-16T15:14:26.634Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-02-26T19:10:28.838Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

